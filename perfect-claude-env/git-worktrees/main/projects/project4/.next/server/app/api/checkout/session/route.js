(()=>{var e={};e.id=23,e.ids=[23],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79646:e=>{"use strict";e.exports=require("child_process")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},28354:e=>{"use strict";e.exports=require("util")},84538:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>P,routeModule:()=>d,serverHooks:()=>h,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>_});var s={};t.r(s),t.d(s,{GET:()=>l,POST:()=>p});var o=t(42706),i=t(28203),n=t(45994),c=t(39187),a=t(98481),u=t(2864);async function p(e){try{let{tier:r,userEmail:t,returnUrl:s}=await e.json();if(!r||!a.z$[r])return c.NextResponse.json({error:"Invalid subscription tier"},{status:400});let o=a.z$[r];if("FREE"===r)return c.NextResponse.json({error:"Free tier does not require checkout"},{status:400});let i=process.env.NEXT_PUBLIC_APP_URL||"http://localhost:3003";if(!(0,u.w5)()){let e=await u.xo.createCheckoutSession({tier:r,userEmail:t||"demo@example.com",returnUrl:s||`${i}/pricing`});return c.NextResponse.json({sessionId:e.id,url:e.url,mode:"mock"})}if(!a._4)throw Error("Stripe not configured");if(!o.priceId)throw Error("Invalid price configuration for tier");let n=await a._4.checkout.sessions.create({mode:"subscription",payment_method_types:["card"],line_items:[{price:o.priceId,quantity:1}],success_url:`${i}/checkout/success?session_id={CHECKOUT_SESSION_ID}`,cancel_url:`${i}/pricing?canceled=true`,customer_email:t||void 0,metadata:{tier:r,userEmail:t||"unknown"},subscription_data:{metadata:{tier:r,userEmail:t||"unknown"}},allow_promotion_codes:!0,billing_address_collection:"auto",automatic_tax:{enabled:!1}});return c.NextResponse.json({sessionId:n.id,url:n.url,mode:"live"})}catch(e){return console.error("Checkout session error:",e),c.NextResponse.json({error:"Failed to create checkout session",details:e.message},{status:500})}}async function l(){return c.NextResponse.json({endpoint:"/api/checkout/session",method:"POST",description:"Create Stripe checkout session for subscription",body:{tier:"PRO | TEAM",userEmail:"user@example.com (optional)",returnUrl:"https://yourdomain.com/pricing (optional)"},modes:{live:"Real Stripe integration (requires API keys)",mock:"Demo mode for testing (no payment required)"},currentMode:(0,u.w5)()?"live":"mock"})}let d=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/checkout/session/route",pathname:"/api/checkout/session",filename:"route",bundlePath:"app/api/checkout/session/route"},resolvedPagePath:"/home/w3bsuki/MCP-RAG-V4/mcp-rag-dev-system/projects/project4/src/app/api/checkout/session/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:_,serverHooks:h}=d;function P(){return(0,n.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:_})}},96487:()=>{},78335:()=>{},2864:(e,r,t)=>{"use strict";t.d(r,{w5:()=>o,xo:()=>s});class s{static createCheckoutSession(e){let r=process.env.NEXT_PUBLIC_APP_URL||"http://localhost:3003";return Promise.resolve({id:"cs_mock_"+Date.now(),url:`${r}/checkout/success?session_id=cs_mock_demo`,payment_status:"unpaid",mode:"subscription"})}static retrieveSession(e){return Promise.resolve({id:e,payment_status:"paid",customer:"cus_mock_"+Date.now(),subscription:"sub_mock_"+Date.now(),mode:"subscription",metadata:{tier:e.includes("pro")?"PRO":"TEAM"}})}static createPortalSession(e){return Promise.resolve({url:`${process.env.NEXT_PUBLIC_APP_URL}/account?demo=portal`})}static retrieveSubscription(e){return Promise.resolve({id:e,status:"active",current_period_end:Math.floor(Date.now()/1e3)+2592e3,items:{data:[{price:{id:"price_mock_pro",unit_amount:1999,recurring:{interval:"month"}}}]}})}}function o(){return!!(process.env.STRIPE_SECRET_KEY&&process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY)}},98481:(e,r,t)=>{"use strict";t.d(r,{_4:()=>o,z$:()=>i});var s=t(9657);t(9248);let o=process.env.STRIPE_SECRET_KEY?new s.A(process.env.STRIPE_SECRET_KEY,{apiVersion:"2025-05-28.basil",typescript:!0}):null,i={FREE:{name:"Free Forever",price:0,priceId:null,features:["100 price checks/day","Basic charts","5 portfolio items","Community support"],limits:{predictionsPerDay:100,portfolioItems:5,chartTimeframes:["24h","7d"],apiCalls:100}},PRO:{name:"Pro",price:1999,priceId:process.env.STRIPE_PRO_PRICE_ID||"price_pro_placeholder",features:["Unlimited AI predictions","All AI features","Unlimited portfolio","Priority support","Advanced charts","Real-time alerts"],limits:{predictionsPerDay:-1,portfolioItems:-1,chartTimeframes:["24h","7d","30d","90d","1y"],apiCalls:-1}},TEAM:{name:"Team",price:4999,priceId:process.env.STRIPE_TEAM_PRICE_ID||"price_team_placeholder",features:["5 user accounts","Shared portfolios","API access","Custom alerts","White-label options","Dedicated support"],limits:{predictionsPerDay:-1,portfolioItems:-1,chartTimeframes:["24h","7d","30d","90d","1y"],apiCalls:-1,teamMembers:5}}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,452,645,184],()=>t(84538));module.exports=s})();